@page "/SukkotAdmin/RegistrationGrid/"

@using static LivingMessiah.Web.Services.Auth0
@using LivingMessiah.Web.Shared.Sukkot
@using LivingMessiah.Web.Pages.SukkotAdmin.Registration.Domain
@using LivingMessiah.Web.Pages.SukkotAdmin.Enums
@using Grid = Syncfusion.Blazor.Grids
@using Syncfusion.Blazor.Inputs
@using Syncfusion.Blazor.Buttons


<AuthorizeView Roles="@Roles.SukkotMenuBar">
	<SukkotAdminMenubar></SukkotAdminMenubar>
</AuthorizeView>

<div class="pb-2 mt-4 mb-4 border-bottom">
	<h3><i class="fas fa-table"></i> Registration Grid</h3>
</div>

<div class="col-lg-12 control-section">
	<div class="form-row">

		<div class="form-group col-md-12">
			<SfNumericTextBox ID="Id"
												@bind-Value="@(SelectedData.Id)"
												Enabled="@Check" FloatLabelType="FloatLabelType.Always" Placeholder="Registration Id">
			</SfNumericTextBox>
		</div>

		<div class="form-group col-md-3">
			<SfTextBox ID="FirstName"
								 @bind-Value="@SelectedData.FirstName"
								 Enabled="@Enabled" Placeholder="First Name" FloatLabelType="FloatLabelType.Always">
			</SfTextBox>
		</div>

		<div class="form-group col-md-3">
			<SfTextBox ID="FamilyName"
								 @bind-Value="@SelectedData.FamilyName"
								 Enabled="@Enabled" Placeholder="Last Name" FloatLabelType="FloatLabelType.Always">
			</SfTextBox>
		</div>

		<div class="form-group col-md-3">
			<SfTextBox ID="SpouseName"
								 @bind-Value="@SelectedData.SpouseName"
								 Enabled="@Enabled" Placeholder="Spouse" FloatLabelType="FloatLabelType.Always">
			</SfTextBox>
		</div>

		<div class="form-group col-md-3">
			<SfTextBox ID="OtherNames"
								 @bind-Value="@SelectedData.OtherNames"
								 Enabled="@Enabled" Placeholder="Other Names" FloatLabelType="FloatLabelType.Always">
			</SfTextBox>
		</div>


		<div class="form-group col-md-6">
			@* ValidationRules="@(new Grid.ValidationRules{ Required=true, Range = new double[]{1, 1000}})   DefaultValue="1"" *@
			<SfTextBox ID="Email"
								 @bind-Value="@SelectedData.EMail"
								 Enabled="@Enabled" Placeholder="Email" FloatLabelType="FloatLabelType.Always">
			</SfTextBox>
		</div>

		<div class="form-group col-md-6">
			<SfMaskedTextBox ID="Phone"
											 @bind-Value="@SelectedData.Phone" Mask="+1-000-000-0000"
											 Enabled="@Enabled" Placeholder="Phone" FloatLabelType="FloatLabelType.Always">
			</SfMaskedTextBox>
		</div>


		<div class="form-group col-md-4">
			<SfNumericTextBox ID="Adults" TValue="int"
												@bind-Value="@SelectedData.Adults" DefaultValue="1"
												Enabled="@Enabled" Placeholder="# Adults" FloatLabelType="FloatLabelType.Always">
			</SfNumericTextBox>
		</div>

		<div class="form-group col-md-4">
			<SfNumericTextBox ID="ChildBig" TValue="int"
												@bind-Value="@SelectedData.ChildBig" DefaultValue="0"
												Enabled="@Enabled" Placeholder="# Children (big)" FloatLabelType="FloatLabelType.Always">
			</SfNumericTextBox>
		</div>

		<div class="form-group col-md-4">
			<SfNumericTextBox ID="ChildSmall" TValue="int"
												@bind-Value="@SelectedData.ChildSmall" DefaultValue="0"
												Enabled="@Enabled" Placeholder="# Children (small)" FloatLabelType="FloatLabelType.Always">
			</SfNumericTextBox>
		</div>


		<div class="form-group col-md-6">
			<SfDropDownList ID="CampId"
											@bind-Value="@SelectedCampTypeName" Enabled="@Enabled"
											TItem="CampType" Placeholder="Camp Type" FloatLabelType="FloatLabelType.Always"
											TValue="string" DataSource="@CampTypeLookupList">
				<DropDownListFieldSettings Value="ID" Text="Text"></DropDownListFieldSettings>
			</SfDropDownList>
		</div>

		<div class="row col-12">

			<div class="form-group col-md-6">
				<p class="mt-3 mb-0"><b>Attendance</b></p>
				<SfCalendar TValue="DateTime?" 
										IsMultiSelection="true" ShowTodayButton="false"
										@bind-Values="@SelectedData.AttendanceDateList"
										Enabled="@Enabled"
										Min="@DateRangeAttendance.DateRange.MinDate"
										Max="@DateRangeAttendance.DateRange.MaxDate">
				</SfCalendar>
			</div>

			<div class="form-group col-md-6">
				<p class="mt-3 mb-0"><b>Lodging</b></p>
				<SfCalendar TValue="DateTime?" ShowTodayButton="false"
										IsMultiSelection="true"
										@bind-Values="@SelectedData.LodgingDateList"
										Enabled="@Enabled" 
										Min="@DateRangeLodging.DateRange.MinDate"
										Max="@DateRangeLodging.DateRange.MaxDate">
				</SfCalendar>
			</div>

		</div>

	</div>

	<div class="row col-12">
		<SfButton CssClass="e-warning" IconCss="e-icons e-cancel" @onclick="Cancel" Disabled="@Disabled">Cancel</SfButton> &nbsp;
		<SfButton CssClass="e-primary" IconCss="e-icons e-save" @onclick="Save" Disabled="@Disabled">Save</SfButton> &nbsp;
		<SfButton CssClass="e-danger" IconCss="e-icons e-delete" @onclick="Delete" Disabled="@Disabled">Delete</SfButton>
		<p class="ml-3 text-black-50"><small>@msg</small></p>
	</div>

	@*
			<div class="row col-12">
			<SfButton  CssClass="e-success" IconCss="e-icons e-add" @onclick="Add"> Add </SfButton>
		</div>*@

</div>

@*
	https://blazor.syncfusion.com/documentation/datagrid/editing#performing-crud-operations-programmatically
	
*@

<div class="col-lg-12 control-section">
	<div class="content-wrapper">
		<div class="row mt-4">

			<SfGrid ID="Grid"
							DataSource="@Registrations" @ref="Grid"
							AllowSelection="true" AllowFiltering="true" AllowSorting="true">
				<GridFilterSettings Type="Syncfusion.Blazor.Grids.FilterType.Menu"></GridFilterSettings>

				@*  CommandClicked="OnSaveClicked" *@

				<GridSortSettings>
					<GridSortColumns>
						<GridSortColumn Field="@nameof(Registration.FirstName)" Direction="SortDirection.Ascending" />
					</GridSortColumns>
				</GridSortSettings>

				<GridEvents RowSelected="RowSelectHandler" RowDeselected="RowDeSelectHandler"
										QueryCellInfo="CustomizeCell" TValue="Registration" />

				<GridColumns>
					<GridColumn Field=@nameof(Registration.Id) HeaderText="Id" IsPrimaryKey="true" Width="35" AllowSorting="true" AllowFiltering="false">
					</GridColumn>

					<GridColumn Field=@nameof(Registration.FirstName) HeaderText="First" Width="50" AllowSorting="true">
					</GridColumn>

					<GridColumn Field=@nameof(Registration.FamilyName) HeaderText="Last" Width="50" AllowSorting="true">
					</GridColumn>

					<GridColumn Field=@nameof(Registration.SpouseName) HeaderText="Spouse" Width="50" AllowSorting="false" AllowFiltering="false">
					</GridColumn>

					@*<GridColumn Field=@nameof(Registration.OtherNames) HeaderText="Other" Width="50" AllowSorting="false"> </GridColumn>*@

					<GridColumn Field=@nameof(Registration.EMail) HeaderText="Email" Width="40" AllowSorting="false" AllowFiltering="false">
					</GridColumn>

					<GridColumn Field=@nameof(Registration.Phone) HeaderText="Phone" Width="40" AllowSorting="false" AllowFiltering="false">
					</GridColumn>

					<GridColumn Field=@nameof(Registration.CampId) HeaderText="Camp Id" Width="40" AllowSorting="false" AllowFiltering="false"></GridColumn>

					<GridColumn Field=@nameof(Registration.LocationName) HeaderText="Location" Width="100"
											FilterSettings="@(new FilterSettings { Type = Syncfusion.Blazor.Grids.FilterType.CheckBox })">

						<GridColumn Field=@nameof(Registration.AttendanceDateList) HeaderText="Addendance" Width="40" AllowSorting="false" AllowFiltering="false"></GridColumn>
						<GridColumn Field=@nameof(Registration.LodgingDateList) HeaderText="Lodging" Width="40" AllowSorting="false" AllowFiltering="false"></GridColumn>

					</GridColumn>

					@*<GridColumn Field=@nameof(Registration.Adults) HeaderText="Adults" Width="25" AllowSorting="false AllowFiltering="false"">
		</GridColumn>

		<GridColumn Field=@nameof(Registration.ChildBig) HeaderText="Child Big" Width="25" AllowSorting="false" AllowFiltering="false">
		</GridColumn>

		<GridColumn Field=@nameof(Registration.ChildSmall) HeaderText="Child Small" Width="25" AllowSorting="false" AllowFiltering="false"> </GridColumn>*@

				</GridColumns>

			</SfGrid>
		</div>
	</div>
</div>
