@page "/SukkotAdmin/DonationsAdd/"

@using Grid = Syncfusion.Blazor.Grids
@using Syncfusion.Blazor.Data
@using Syncfusion.Blazor.Buttons
@using LivingMessiah.Web.Pages.SukkotAdmin.Donations.Domain
@using LivingMessiah.Web.Pages.SukkotAdmin.Donations.Data


<h3>Registration Lookup</h3>

<div class="col-lg-12 control-section">
	<div class="control_wrapper">
		<SfAutoComplete Placeholder="Select a Registrant" @bind-Value="@SelectedRegistrantName"
										DataSource="@RegistrationLookupList">
			<AutoCompleteFieldSettings Value="Text"></AutoCompleteFieldSettings>
			<AutoCompleteEvents TItem="RegistrationLookup" TValue="string" OnValueSelect="OnSelect"></AutoCompleteEvents>
		</SfAutoComplete>
	</div>
</div>

<h3 class="text-primary mt-4">Selected Registrant: @SelectedRegistrantName <sup>(@SelectedRegistrantId)</sup></h3>

<style>
	.control_wrapper {
		width: 350px;
		margin: 0 auto;
		padding-top: 70px;
	}

	.sfButton {
		padding-top: 20px;
		display: flex;
		justify-content: center;
	}

	.validation-message {
		color: red;
		padding-top: 5px;
	}
</style>

<div class="col-lg-12 control-section">
	<div class="content-wrapper">
		<div class="row">
			<SfGrid @ref="GridAdd" DataSource="@DonationDetails" Toolbar="@(new List<string>() { "Add", "Update", "Cancel" })">

				<GridEditSettings AllowAdding="true" AllowEditing="false" AllowDeleting="false"></GridEditSettings>
				<GridEvents CommandClicked="OnSaveClicked" TValue="DonationDetail" OnActionFailure="Failure"></GridEvents>

				<GridColumns>

					<GridColumn Field="@nameof(DonationDetail.Id)" IsPrimaryKey="true" Visible="true"
											HeaderText="Id" Width="45" AllowAdding="false">
					</GridColumn>

					<GridColumn Field="@nameof(DonationDetail.RegistrationId)"
											ValidationRules="@(new Grid.ValidationRules{ Required=true})"
											HeaderText="Reg Id" Width="45" Visible="true" AllowAdding="false">
					</GridColumn>

					<GridColumn Field="@nameof(DonationDetail.Detail)" Visible="true"
											HeaderText="Dtl" Width="45" AllowAdding="false">
					</GridColumn>

					<GridColumn Field=@nameof(DonationDetail.Amount) HeaderText="Amount"
											ValidationRules="@(new Grid.ValidationRules{ Required=true, Range = new double[]{1, 1000}})"
											Width="70" Format="c0" TextAlign="TextAlign.Right">
					</GridColumn>

					<GridColumn Field=@nameof(DonationDetail.Notes) HeaderText="Notes" Width="110">
					</GridColumn>

					<GridColumn Field=@nameof(DonationDetail.ReferenceId) HeaderText="Reference"
											ValidationRules="@(new Grid.ValidationRules{ Required=true})" Width="120">
					</GridColumn>

					<GridColumn Field=@nameof(DonationDetail.CreateDate) HeaderText="Date"
											ValidationRules="@(new Grid.ValidationRules{ Required=true})"
											DefaultValue="@(DateTime.Now)"
											EditType="EditType.DatePickerEdit" Format="d" Type="ColumnType.Date" TextAlign="TextAlign.Right" Width="70">
					</GridColumn>

					<GridColumn Field="@nameof(DonationDetail.CreatedBy)" Visible="true"
											HeaderText="Created by" Width="65" AllowAdding="false">
					</GridColumn>

					<GridColumn Width="75">
						<GridCommandColumns>
							<GridCommandColumn Type="CommandButtonType.Save"
																 ButtonOption="@(new CommandButtonOptions() {IconCss="e-icons e-save", CssClass="e-flat" })">
							</GridCommandColumn>
						</GridCommandColumns>
					</GridColumn>

					@* agrid is dialog edit mode) 	Can I make it ? How ?	Thanks HB *@

				</GridColumns>
				@*<GridEvents TValue="DonationDetail" OnActionFailure="Failure"></GridEvents>*@
			</SfGrid>

		</div>
	</div>
</div>


@if (DatabaseError)
{
	<p class="text-danger"><em>@DatabaseErrorMsg</em></p>
}
else
{
	if (DatabaseWarning)
	{
		<p class="text-warning">@DatabaseWarningMsg</p>
	}
}

@*
	<SfButton @ref="AddBtn" @onclick="@((args) => AddBtnHandler(args, dtl))">Add</SfButton>

							<SfButton @onclick="Add"> Add Detail Record</SfButton>

	Toolbar="@(new List<string>() { "Add", "Update", "Cancel" })"
*@