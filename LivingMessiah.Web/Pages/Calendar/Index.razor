@page "/Calendar"
@using Page = LivingMessiah.Web.Links.Calendar
@using Syncfusion.Blazor.Schedule
@using static LivingMessiah.Web.Pages.Calendar.ScheduleData

<p class="my-1 float-right text-black-50"><small>Year: @YearId</small></p>

<div class="pb-1 mt-4 mb-5 border-bottom border-info bor">
	<h2><i class="@Page.Icon"></i> @Page.Title</h2>
</div>




<div class="row">
	<div class="col-12">

		<SfSchedule TValue="ReadonlyEventsData"
								MonthsCount="@NumberOfMonths"
								MinDate="@CalendarRange.MinDate" MaxDate="@CalendarRange.MaxDate"
								Width="100%" Height="650px"
								@bind-SelectedDate="@CurrentDate" @bind-CurrentView="@ViewNow">

			<ScheduleEventSettings DataSource="@AppointmentDataList"></ScheduleEventSettings>
			<ScheduleEvents TValue="ReadonlyEventsData"
											EventRendered="OnEventRendered" />
			<ScheduleViews>
				<ScheduleView Option="View.Week"></ScheduleView>
				<ScheduleView Option="View.Month"></ScheduleView>
				<ScheduleView Option="View.Year"></ScheduleView>
			</ScheduleViews>


		</SfSchedule>
	</div>
</div>

<ButtonShowHide Title="Appointment List">
	<ChildContent>
		<div class="card-body  m-0 px-4">

			<LoadingComponent IsLoading="AppointmentDataList==null">
				<TableTemplate Items="AppointmentDataList">
					<TableHeader>
						<th>Id</th>
						<th>Subject</th>
						<th>Description</th>
						<th>Start Time</th>
						<th>End Time</th>
					</TableHeader>
					<RowTemplate>
						<td>@context.Id</td>
						<td>@context.Subject</td>
						<td>@context.Description</td>
						<td>@context.StartTime.ToShortDateString()</td>
						<td>@context.EndTime.ToShortDateString()</td>
					</RowTemplate>
				</TableTemplate>
			</LoadingComponent>

		</div>
	</ChildContent>
</ButtonShowHide>


@if (DatabaseError)
{
	<p class="text-danger"><em>@DatabaseErrorMsg</em></p>
}
else
{
	if (DatabaseWarning)
	{
		<p class="text-warning">@DatabaseWarningMsg</p>
	}
}
