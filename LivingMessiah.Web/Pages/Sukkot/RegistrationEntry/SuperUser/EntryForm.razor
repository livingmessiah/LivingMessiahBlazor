@using static LivingMessiah.Web.Services.Auth0
@using LivingMessiah.Web.Shared.Sukkot
@using LivingMessiah.Web.Pages.Sukkot.RegistrationEntry
@using LivingMessiah.Web.Pages.Sukkot.RegistrationSteps.Enums
@using Blazored.FluentValidation

<LoadingComponent IsLoading="VM==null">

	<div class="row mt-2">

		<div class="col-8">
			<div class="card border-info">
				<SfAutoComplete Placeholder="Select a Registrant to edit" @bind-Value="@SelectedRegistrantName"
												DataSource="@RegistrationLookupList">
					<AutoCompleteFieldSettings Value="Text"></AutoCompleteFieldSettings>
					<AutoCompleteEvents TItem="RegistrationLookup"
															ValueChange="OnValueChanged"
															TValue="string"
															OnValueSelect="OnSelect"></AutoCompleteEvents>
				</SfAutoComplete>
			</div>
		</div>

		<div class="col-4">
			<p>Filter by name</p>
		</div>
	</div>

	@if (ShowEditForm)
	{
		<EditForm Model="VM" OnValidSubmit="HandleValidSubmit"
						class="card card-body bg-light mt-5">
			<FluentValidationValidator @ref="_fluentValidationValidator" DisableAssemblyScanning="@true" />
			<ValidationSummary />

			<fieldset class="py-1 my-0">
				<legend class="text-success text-center"> @Title</legend>
			</fieldset>

			<fieldset class="mt-3">
				<legend class="text-primary">Contact Information</legend>

				<div class="row mt-n2">

					<div class="col-sm-4">
						<div class="mb-3">
							<label for="familyName" class="control-label">Family Name</label>
							<InputText id="familyName" class="form-control" @bind-Value="VM!.FamilyName" />
							<ValidationMessage For="@(() => VM.FamilyName)" />
						</div>
					</div>

					<div class="col-sm-4">
						<div class="mb-3">
							<label for="firstName" class="control-label">First Name</label>
							<InputText id="firstName" class="form-control" @bind-Value="VM.FirstName" />
							<ValidationMessage For="@(() => VM.FirstName)" />
						</div>
					</div>

					<div class="col-sm-4">
						<div class="mb-3">
							<label for="spouseName" class="control-label">Spouses Name</label>
							<InputText id="spouseName" class="form-control" @bind-Value="VM.SpouseName" />
							<ValidationMessage For="@(() => VM.SpouseName)" />
						</div>
					</div>

				</div>

				<div class="row">

					<div class="col-sm-4">
						<div class="mb-3">
							<label for="otherNames" class="control-label">Other Names</label>
							<InputText id="otherNames" class="form-control" @bind-Value="VM.OtherNames" />
							<ValidationMessage For="@(() => VM.OtherNames)" />
						</div>
					</div>

					<div class="col-sm-4">
						<div class="mb-3">
							<label for="email" class="control-label">Email</label>
							<InputText id="email" class="form-control" @bind-Value="VM.EMail" placeholder="email" />
							<ValidationMessage For="@(() => VM.EMail)" />
						</div>
					</div>

					<div class="col-sm-4">
						<div class="mb-3">
							<label for="phone" class="control-label">Phone</label>
							<InputText id="phone" class="form-control" @bind-Value="VM.Phone" placeholder="phone (optional)" />
							<ValidationMessage For="@(() => VM.Phone)" />
						</div>
					</div>

				</div>

			</fieldset>

			<fieldset class="mt-3">
				<legend class="text-primary">Attendance</legend>

				<div class="row mt-n2">

					<div class="col-sm-12">
						<div class="card bg-light mb-3">
							<div class="card-body">
								<p class="card-text">What days will you be attending?  This helps us with planning.</p>
							</div>
						</div>
					</div>

				</div>

				<div class="row mt-n2">

					<div class="col-sm-6">
						<div class="mb-3">
							<SfCalendar TValue="DateTime?"
												IsMultiSelection="true" ShowTodayButton="false"
												@bind-Values="@VM.AttendanceDateList"
												Min="@DateRangeAttendance.Range.Min"
												Max="@DateRangeAttendance.Range.Max">
							</SfCalendar>

						</div>
					</div>

					<div class="col-sm-6">
						<div class="mb-3">
							<SfCalendar TValue="DateTime?"
												IsMultiSelection="true" ShowTodayButton="false"
												@bind-Values="@VM.AttendanceDateList2ndMonth"
												Min="@DateRangeAttendance.Range2ndMonth.Min"
												Max="@DateRangeAttendance.Range2ndMonth.Max">
							</SfCalendar>

						</div>
					</div>

				</div>
			</fieldset>

			<fieldset class="mt-3">
				<legend class="text-primary">People Count</legend>

				<div class="row mt-n2">
					<div class="col-sm-3">

						<div class="mb-3">

							<label for="adults" class="control-label">Adults</label>
							<InputNumber id="adults" class="form-control" @bind-Value="VM.Adults" />
							<ValidationMessage For="@(() => VM.Adults)" />

						</div>
					</div>

					<div class="col-sm-3">
						<div class="mb-3">
							<label for="childBig" class="control-label">Child <sup>big</sup></label>
							<InputNumber id="childBig" class="form-control" @bind-Value="VM.ChildBig" />
							<ValidationMessage For="@(() => VM.ChildBig)" />
						</div>
					</div>

					<div class="col-sm-3">
						<div class="mb-3">
							<label for="childSmall" class="control-label">Child <sup>small</sup></label>
							<InputNumber id="childSmall" class="form-control" @bind-Value="VM.ChildSmall" />
							<ValidationMessage For="@(() => VM.ChildSmall)" />
						</div>
					</div>

					<div class="col-sm-3">
					</div>

				</div>
			</fieldset>

			<fieldset class="mt-3">
				<legend class="text-primary">Other</legend>
				<div class="row mt-n2">
					<div class="col-sm-12">
						<div class="mb-3">
							<label for="notes" class="control-label"><small>Notes / Emergency Contact / Fellowship Attending</small></label>
							<p class="">
								Please include emergency contact and name of fellowship or congregation currently attending, if none list a personal reference
							</p>
							<InputTextArea id="notes" class="form-control" @bind-Value="VM.Notes" />
							<ValidationMessage For="@(() => VM.Notes)" />

						</div>
					</div>
				</div>

			</fieldset>

			<fieldset class="mt-3">
				<legend class="text-primary">Status</legend>

				<div class="row mt-n2">

					<div class="col-sm-12">
						<label for="statusEnum" class="control-label">Status Type</label>
						<InputSelect id="type" @bind-Value="VM.StatusId" class="form-control">
							@foreach (var item in Status.List.ToList())
							{
								<option value="@item.Value">@item.Heading</option>
							}
						</InputSelect>
						<ValidationMessage For="@(() => VM.StatusId)" />
					</div>

				</div>

			</fieldset>

			<div class="row mt-3">
				<div class="col-sm-6">
					<div class="mb-3">
						<button class="btn btn-success btn-lg">
							<i class="fas fa-save"></i> Save
						</button>
					</div>

				</div>
			</div>

		</EditForm>

	}

</LoadingComponent>


